<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>TheHUB</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
	<link href="style.css" rel="stylesheet">
</head>


<body>
	<div class="container-fluid">
		<header>
			<img src="logo.png" width="200px" />
			<label>User</label>
			<input type="text"  placeholder="BB">
			<label>Pass</label>
			<input type="text"  placeholder="KSD64">
		</header>
		<main>
			<div class="row">
				<! Live Purchase Feed >
				<div class="col-sm-4">
					<h1 class=columnHead>FEED</h1>	
					<table class="table table-striped">
						<thead>
							<tr>
								<th>Date</th>
								<th>Item</th>
								<th>Purchaser</th>
								<th>Cost</th>
								<th>Exclusions</th>
								
							</tr>
						</thead>
						<tbody id="feed"></tbody>
					</table>
				</div>



				<! Automated Purchase Interface >
				<div class="col-sm-4">
					<h1 class=columnHead>QUICKBUY</h1>
					<div class="row productView">
						<aside class="col-md-3 productImageFrame">
							<img class="productImage"src="productResources/towels.png">
						</aside>
						<div class="col-md-6">
							<div class="info-main">
								<a href="https://www.amazon.com/Bounty-Quick-Size-Paper-Towels-Family/dp/B079VP6DH6/ref=sr_1_2_sspa?crid=3QR46WM3LIMFE&dchild=1&keywords=paper+towels&qid=1614756558&sprefix=paper+t%2Caps%2C235&sr=8-2-spons&psc=1&spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUExTEFMN1JSNDZPRUFHJmVuY3J5cHRlZElkPUEwMDkzNjgxMTVSR0EwN0tSUFU3UiZlbmNyeXB0ZWRBZElkPUEwMjgzNTg5MTU2SzQxOUhIRExCWCZ3aWRnZXROYW1lPXNwX2F0ZiZhY3Rpb249Y2xpY2tSZWRpcmVjdCZkb05vdExvZ0NsaWNrPXRydWU="> <h3>Paper Towels </h3></a>
								<p> Last Purchased by ___ on ____ </p>
							</div>
						</div>
						<aside class="col-sm-3 ">
							<h4> $30.44 </h4>	
							<br>
							<a href="#" class="btn btn-primary"> Order Now </a>
						</aside>
					</div>
					<br>
					<div class="row productView">
						<div class="col-md-3 productImageFrame">
							<img class="productImage" src="productResources/foil.png">
						</div>
						<div class="col-md-6">
							<div class="info-main">
								<a href="https://www.amazon.com/Reynolds-Wrap-Heavy-Aluminum-Square/dp/B00M8ZEAW4/ref=sr_1_3_sspa?crid=36UENJRR9JZF1&dchild=1&keywords=aluminum+foil&qid=1614757628&sprefix=aluminum%2Caps%2C235&sr=8-3-spons&psc=1&spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUFVTjZCTDFQNUlIVzcmZW5jcnlwdGVkSWQ9QTAxMTk5MzYzUzJVOTZBMlBNMlBZJmVuY3J5cHRlZEFkSWQ9QTEwMTMzMjYxQkJCTTJTR0Y3TTVGJndpZGdldE5hbWU9c3BfYXRmJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ=="> <h3>Aluminum Foil </h3></a>
								<p> Last Purchased by ___ on ____ </p>
							</div>
						</div>
						<aside class="col-sm-3">
							<h4> $9.98 </h4>	
							<br>
							<a href="#" class="btn btn-primary"> Order Now </a>
						</aside>
					</div>
					<br>
					<div class="row productView">
						<aside class="col-md-3 productImageFrame">
							<img class="productImage"src="productResources/oliveoil.png">
						</aside>
						<div class="col-md-6">
							<div class="info-main">
								<a href="https://www.amazon.com/Pompeian-Pressed-Full-Bodied-Dressings-Marinades/dp/B08L4MLRXZ/ref=sr_1_1_sspa?dchild=1&keywords=olive+oil&qid=1614757743&sr=8-1-spons&psc=1&spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUExWkVSQUhJVDVPOExPJmVuY3J5cHRlZElkPUEwOTkyMzY1V1VDQVcyV0c1RTFaJmVuY3J5cHRlZEFkSWQ9QTAxNjA4ODMzSjU5UFY3MEswTlJUJndpZGdldE5hbWU9c3BfYXRmJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ=="> <h3>Olive Oil </h3></a>
								<p> Last Purchased by ___ on ____ </p>
							</div>
						</div>
						<aside class="col-sm-3">
							<h4> $22.25 </h4>	
							<br>
							<a href="#" class="btn btn-primary"> Order Now </a>
						</aside>
					</div>
				</div>

				<! Purchase log form >
				<div class="col-sm-4">
					<h1 class=columnHead>ADD CHARGE</h1>
					<form name="submit-to-google-sheet">
						<div class="form-row">
							<div class="col form-group">
								<label>First name</label>
								<input name="Purchaser" type="text" class="form-control" placeholder="lil' cletus">
							</div>
							<div class="col form-group">
								<label>Item</label>
								<input name="Item" type="text" class="form-control" placeholder="milk">
							</div>
							<div class="col form-group">
								<label>Price</label>
								<input name="Cost" type="text" class="form-control" placeholder="420.69">
							</div>
							<div class="col form-group">
								<label>Date</label>
								<input name="Date" type="text" class="form-control" placeholder="MM/DD">
							</div>
							<div class="col form-group">
								<label>Exclusions</label>
								<input name="Exclusions" type="text" class="form-control" placeholder="kurt probably">
							</div>



							<div class="form-group">
								<button type="submit" class="btn btn-primary btn-block"> Submit  </button>
							</div> 
						</div>      
					</form>
				</div>
			</div>

			<footer>
				<input type="checkbox" class="custom-control-input" checked=""> 
				<label >I'm 18+ (I'm not dumb and checked my stuff)</label> 
			</footer>
		</div>
	</main>
</body>


<script>
	//Send form data to Google 'autocosts' sheet
	const scriptURL = 'https://script.google.com/macros/s/AKfycbxZj0Uct5N-ZVsJBWipwO2XCuR-qkNKNhc1SN5yfooFxTyVTevHnXNIhRovAE1ZjM7f/exec'
	const form = document.forms['submit-to-google-sheet']

	form.addEventListener('submit', e => {
		e.preventDefault()
		fetch(scriptURL, { method: 'POST', body: new FormData(form)})
		.then(response => console.log('Success!', response))
		.catch(error => console.error('Error!', error.message))
	})
	//End 


	//Retrieve Live Google Sheet Data
	let xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function () {
		if (this.readyState == 4 && this.status == 200) {
			let data = JSON.parse(this.responseText).feed.entry;
			let i;
			for (i = 0; i < data.length; i++) {
				let date = data[i]["gsx$date"]["$t"];
				let item = data[i]["gsx$item"]["$t"];
				let purchaser = data[i]["gsx$purchaser"]["$t"];
				let cost = data[i]["gsx$cost"]["$t"];
				let exclusions = data[i]["gsx$exclusions"]["$t"];

				document.getElementById("feed").innerHTML +=
				"<tr>" +
				"<td>" +
				date +
				"</td>" +
				"<td>" +
				item +
				"</td>" +
				"<td>" +
				purchaser +
				"</td>" +
				"<td>" +
				cost +
				"</td>" +
				"<td>" +
				exclusions +
				"</td>" +
				"</tr>";
			}
		}
	};

	xmlhttp.open(
		"GET",
		"https://spreadsheets.google.com/feeds/list/1J3e1Ty8Iih2agrLGCU7dNhRsPrtqGeOS4jdJJXX6r5Y/od6/public/values?alt=json",
		true
		);
	xmlhttp.send();
</script>

</html>

